% Assignment #6, Per Jesper Sjšstršm% 2/27/00, The I&F neuron% Now produce an I-f curve%%% InitE_L = -70e-3;					% Leakage current reversal potential [V]R_m = 10e6;						% Input resistance of the cell [Ohm]tau_m = 10e-3;					% Membrane time constant [s]V_th = -54e-3;					% Threshold for spiking [V]V_reset = -80e-3;				% Reset value, after a spike [V]V_max = 40e-3;					% Size of a spike [V]n_points = 16;I_e_vec = ...	linspace(0,4e-9,n_points);	% Range of the injected current [A]freq_vec = zeros(1,n_points);	% Store away the frequencies [Hz]t_max = 1;						% [s]dt = 0.0001;					% [s]t_vec = 0:dt:t_max;V_vec = zeros(n_points,length(t_vec));	% [V]%%% Loopfor j = 1:length(I_e_vec),		I_e = I_e_vec(j);			% Set the current to be injected	V = E_L;					% Initiate the membrane potential to the leakage reversal [V]	for i = 1:length(t_vec),			V_vec(j,i) = V;			% Store away the membrane voltage				if (V==V_max)			% Previous step was a spike?			V = V_reset;		% If so, do a reset		end;		V = E_L + R_m*I_e + (V - E_L - R_m*I_e )*exp(-dt/tau_m);		if (V>V_th),			% Above threshold?			V = V_max;			% If so, produce the spike		end;		end;		indeces = ...		find(V_vec==V_max);		% Find the frequency for this iteration	freq_vec(j) = length(indeces)/t_max;	end;%%%%% Calculate the firing rate analyticallyfreq_analyt = 1./( tau_m*log(E_L+R_m*I_e_vec-V_reset) - tau_m*log(E_L+R_m*I_e_vec-V_th) );freq_analyt(find(imag(freq_analyt)~=0)) = 0;	% Remove imaginary firing rates%%% Plotfigure(1);orient tall;subplot(1,1,1);plot(t_vec,V_vec);xlabel('time [s]');ylabel('ampl [V]');figure(2);orient landscape;subplot(1,1,1);h = plot(I_e_vec,freq_vec,'-^b',I_e_vec,freq_analyt,'--vr');xlabel('I_e [A]');ylabel('f [Hz]');legend(h,'numerical','analytical');