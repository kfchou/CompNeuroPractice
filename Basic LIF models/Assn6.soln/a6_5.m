% Assignment #6, Per Jesper Sjšstršm% 2/29/00, Two synaptically connected I&F neurons% Both neurons are identical with respect to all constant properties% ... but start at different initial voltages%%% Initexcitatory = 0;					% Boolean: Use excitatory synapse if true, otherwise inhibitory% CellV_rest = -70e-3;				% The resting membrane potential [V]R_m = 10e6;						% Input resistance of the cell [Ohm]tau_m = 10e-3;					% Membrane time constant [s]V_th = -54e-3;					% Threshold for spiking [V]V_reset = -80e-3;				% Reset value, after a spike [V]V_max = 40e-3;					% Size of a spike [V]sigma = 2e-3;					% Sigma for initial voltage [V]V1 = V_rest+randn*sigma;		% Initiate the membrane potential to the leakage reversal [V]V2 = V_rest+randn*sigma;		% Initiate the membrane potential to the leakage reversal [V]I_e = 1.8e-9;					% Current injection into both cells [A]% Synapses_tau = 0.01;					% Time constant for alpha function [s]s_max = 1;						% Max amplitude of synaptic gating [unitless]g_s = 0.005e-6;					% Synaptic conductance [S]if (excitatory),	E_s = 0;					% Synaptic reversal potential [V]else	E_s = -80e-3;				% Synaptic reversal potential [V]end;s_1 = 0;						% Cell 1: Synapse first order gating is closed [unitless]s2_1 = 0;						% Cell 1: Synapse second order gating is closed [unitless]s_2 = 0;						% Cell 2: Synapse first order gating is closed [unitless]s2_2 = 0;						% Cell 2: Synapse second order gating is closed [unitless]e = exp(1);						% The number ei_syn_1 = 0;					% Synaptic current in cell 1 [A]i_syn_2 = 0;					% Synaptic current in cell 2 [A]% Vectorsdt = 0.0001;					% [s]t_max = 1;						% [s]t_vec = 0:dt:t_max;				% [s]V1_vec = zeros(1,length(t_vec));	% [V]V2_vec = zeros(1,length(t_vec));	% [V]i_syn_1_vec = zeros(1,length(t_vec));	% synaptic current in cell 1 [A]i_syn_2_vec = zeros(1,length(t_vec));	% synaptic current in cell 2 [A]%%% Loopfor i = 1:length(t_vec),	V1_vec(i) = V1;				% Store away the membrane voltage 1	V2_vec(i) = V2;				% Store away the membrane voltage 2	i_syn_1_vec(i) = i_syn_1;	% Store away the synaptic current 1	i_syn_2_vec(i) = i_syn_2;	% Store away the synaptic current 2		if (V1==V_max)				% Previous step was a spike in cell 1?		V1 = V_reset;			% If so, do a reset...		s2_2 = s_max;			% ... and produce an EPSP in cell 2	end;	if (V2==V_max)				% Previous step was a spike in cell 2?		V2 = V_reset;			% If so, do a reset		s2_1 = s_max;			% ... and produce an EPSP in cell 1	end;	s_1 = s_1 + dt*((e*s2_1-s_1)/s_tau);	s_2 = s_2 + dt*((e*s2_2-s_2)/s_tau);    	s2_1 = s2_1 + dt*(-s2_1/s_tau);	s2_2 = s2_2 + dt*(-s2_2/s_tau);	tau_v_1 = tau_m/(1+R_m*g_s*s_1);	tau_v_2 = tau_m/(1+R_m*g_s*s_2);	V_inf_1 = (V_rest+R_m*g_s*s_1*E_s+R_m*I_e)/(1+R_m*g_s*s_1);	V_inf_2 = (V_rest+R_m*g_s*s_2*E_s+R_m*I_e)/(1+R_m*g_s*s_2);	i_syn_1 = -g_s*s_1*(E_s-V1);	i_syn_2 = -g_s*s_2*(E_s-V2);	V1 = V_inf_1 + (V1-V_inf_1)*exp(-dt/tau_v_1);	V2 = V_inf_2 + (V2-V_inf_2)*exp(-dt/tau_v_2);	if (V1>V_th),				% Cell 1 above threshold?		V1 = V_max;				% If so, produce the spike in cell 1	end;	if (V2>V_th),				% Cell 2 above threshold?		V2 = V_max;				% If so, produce the spike in cell 2	end;    k1(i) = s_1;    k2(i) = s2_1;end;%%% Plottstart = 0;						% Beginning of plottend = t_max;					% End of ploti1 = floor(tstart/dt)+1;		% Convert the above to indecesi2 = floor(tend/dt)+1;figure(3);subplot(2,1,1); plot(t_vec,k1); ylabel('s_1')subplot(2,1,2); plot(t_vec,k2); ylabel('s2_1')figure(2);orient tall;subplot(4,1,1);plot(t_vec(i1:i2),V1_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('ampl [V]');subplot(4,1,2);plot(t_vec(i1:i2),V2_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('ampl [V]');subplot(4,1,3);plot(t_vec(i1:i2),i_syn_1_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('current [A]');subplot(4,1,4);plot(t_vec(i1:i2),i_syn_2_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('current [A]');tstart = t_max-0.1;				% Beginning of plottend = t_max;					% End of ploti1 = floor(tstart/dt)+1;		% Convert the above to indecesi2 = floor(tend/dt)+1;figure(1);subplot(4,1,1);orient tall;plot(t_vec(i1:i2),V1_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('ampl [V]');subplot(4,1,2);plot(t_vec(i1:i2),V2_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('ampl [V]');subplot(4,1,3);plot(t_vec(i1:i2),i_syn_1_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('current [A]');subplot(4,1,4);plot(t_vec(i1:i2),i_syn_2_vec(i1:i2));axis tight;xlabel('time [s]');ylabel('current [A]');